<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ninja Lead Truyền Kỳ - Mở Rộng</title>
    <script src="https://cdn.tailwindcss.com"></script>

</head>

<body class="bg-gray-900 h-screen w-screen flex flex-col items-center justify-center relative">

    <!-- UI: HUD (Lives, Score & Progress) -->
    <div id="hud" class="absolute top-0 left-0 w-full p-4 z-10 hidden flex flex-col">
        <div class="flex justify-between items-start text-white font-bold drop-shadow-md">
            <div class="flex flex-col gap-1">
                <div class="bg-black/50 px-3 py-1 rounded border border-white/20">Màn: <span
                        id="current-level-display">1</span></div>
                <div id="lives-display" class="text-2xl mt-1 tracking-widest">❤️❤️❤️</div>
            </div>
            <div class="bg-black/50 px-3 py-1 rounded border border-white/20">Điểm: <span id="score">0</span></div>
        </div>

        <div class="progress-container max-w-md mx-auto relative mt-2">
            <div id="progress-bar" class="progress-bar"></div>
            <div class="absolute inset-0 flex items-center justify-center text-xs font-bold text-white drop-shadow-md">
                ĐÍCH ĐẾN</div>
        </div>
    </div>

    <!-- UI: Ninja Mode Warning -->
    <div id="ninja-warning" class="absolute top-24 w-full text-center hidden z-20 pointer-events-none">
        <h1
            class="text-4xl md:text-5xl text-yellow-300 font-black game-font blink drop-shadow-[0_4px_4px_rgba(0,0,0,0.8)] stroke-black">
            ⚠ MODE NINJA! ⚠
        </h1>
        <p class="text-white text-lg font-bold bg-red-600 inline-block px-3 py-1 rounded mt-1">ĐIỀU KHIỂN BỊ NGƯỢC!</p>
    </div>

    <!-- UI: Main Menu / Character Select -->
    <div id="menu-screen"
        class="absolute inset-0 bg-gray-900 flex flex-col items-center justify-center z-50 text-white p-4 overflow-y-auto">
        <h1 class="text-5xl md:text-7xl text-pink-500 mb-2 game-font tracking-wider text-center">NINJA LEAD</h1>
        <p class="text-gray-400 mb-6 italic">Truyền Kỳ Phố Thị</p>

        <div class="bg-gray-800 p-4 rounded-xl w-full max-w-2xl border border-gray-700 shadow-2xl">
            <h2 class="text-2xl font-bold mb-4 text-center text-yellow-400">CHỌN NHÂN VẬT</h2>
            <div id="character-list" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                <!-- Character items generated by JS -->
            </div>

            <div class="border-t border-gray-700 pt-4 mb-4">
                <h3 class="text-xl font-bold text-center mb-2" id="selected-name">Ninja Lead</h3>
                <p class="text-center text-gray-400 text-sm" id="selected-desc">Huyền thoại đường phố. Né mọi thứ trừ...
                    ý thức.</p>
            </div>

            <div class="text-center">
                <button onclick="startGame()"
                    class="bg-gradient-to-r from-pink-600 to-purple-600 hover:from-pink-500 hover:to-purple-500 text-white font-bold py-4 px-12 rounded-full text-2xl shadow-lg transform transition hover:scale-105 active:scale-95 border-b-4 border-purple-900 w-full md:w-auto">
                    BẮT ĐẦU ĐUA!
                </button>
            </div>
        </div>
        <p class="mt-4 text-xs text-gray-500">Hoàn thành màn chơi để mở khóa nhân vật mới!</p>
    </div>

    <!-- UI: Level Complete (Victory) Screen -->
    <div id="victory-screen"
        class="absolute inset-0 bg-green-900/95 flex flex-col items-center justify-center z-40 hidden text-white p-4 text-center">
        <h1 class="text-5xl md:text-7xl text-yellow-300 mb-4 game-font animate-bounce">VỀ ĐÍCH!</h1>
        <div class="text-6xl mb-4">🏁🏆🏁</div>
        <p class="text-xl mb-4">Bạn đã hoàn thành màn chơi!</p>

        <div id="unlock-message" class="bg-white/10 p-4 rounded-lg border border-yellow-400/50 mb-6 hidden">
            <p class="text-yellow-300 font-bold text-lg">MỞ KHÓA NHÂN VẬT MỚI!</p>
            <div id="new-char-icon" class="text-6xl mt-2 animate-pulse">🛵</div>
            <div id="new-char-name" class="font-bold mt-1">???</div>
        </div>

        <button onclick="returnToMenu()"
            class="bg-green-600 hover:bg-green-500 text-white font-bold py-3 px-8 rounded-full text-xl shadow-lg border-b-4 border-green-800">
            Tiếp tục
        </button>
    </div>

    <!-- UI: Game Over Screen -->
    <div id="game-over-screen"
        class="absolute inset-0 bg-red-900/90 flex flex-col items-center justify-center z-40 hidden text-white p-4 text-center">
        <h1 class="text-6xl text-yellow-400 mb-2 game-font">HẾT MẠNG!</h1>
        <p class="text-4xl mb-4">💔💔💔</p>
        <p id="final-reason" class="text-xl mb-6 font-bold">Bạn đã va chạm quá nhiều!</p>
        <button onclick="startGame()"
            class="bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-10 rounded-full text-xl shadow-lg transform transition hover:scale-105 border-b-4 border-blue-800">
            ĐUA LẠI
        </button>
        <button onclick="returnToMenu()" class="mt-4 text-gray-300 underline hover:text-white">
            Về Menu Chính
        </button>
    </div>

    <!-- Canvas -->
    <canvas id="game-canvas" class="shadow-2xl rounded-lg max-w-full max-h-full"></canvas>

    <!-- Mobile Controls Hints -->
    <div
        class="absolute bottom-4 w-full flex justify-between px-8 pointer-events-none md:hidden opacity-50 text-white text-4xl z-0">
        <span>⬅ Vuốt</span>
        <span>Vuốt ➡</span>
    </div>

    <script src="main.js"></script>
</body>

</html>